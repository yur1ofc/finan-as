<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finan√ßas360 - Controle Financeiro Completo</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #fca311;
            --info: #4895ef;
            --dark: #2b2d42;
            --light: #f8f9fa;
            --gray: #8d99ae;
            --card-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
            --card-radius: 16px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7ec 100%);
            color: var(--dark);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
            position: relative;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 25px;
            background: white;
            border-radius: var(--card-radius);
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .tab {
            flex: 1;
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }
        
        .tab::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: var(--primary);
            transition: var(--transition);
            transform: translateX(-50%);
        }
        
        .tab:hover::after {
            width: 50%;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab.active::after {
            width: 80%;
            background: white;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .dashboard-card {
            background: white;
            border-radius: var(--card-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
        }
        
        .dashboard-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary);
        }
        
        .dashboard-card h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 500;
        }
        
        .dashboard-value {
            font-size: 26px;
            font-weight: 700;
            margin: 10px 0;
            font-family: 'Montserrat', sans-serif;
        }
        
        .value-positive {
            color: var(--success);
        }
        
        .value-negative {
            color: var(--danger);
        }
        
        .value-neutral {
            color: var(--primary);
        }
        
        .real-time {
            font-size: 14px;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: white;
            padding: 25px;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        .control-group:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .control-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .control-title i {
            margin-right: 10px;
            color: var(--primary);
            font-size: 20px;
        }
        
        .input-group {
            margin-bottom: 18px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: var(--transition);
            background: #f9fafb;
        }
        
        .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
            background: white;
        }
        
        .btn {
            padding: 14px 22px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #3a86ff);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #b5179e);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #f77f00);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .card {
            background-color: white;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            padding: 30px;
            margin-bottom: 30px;
            transition: var(--transition);
        }
        
        .card:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .card-title i {
            margin-right: 12px;
            color: var(--primary);
            font-size: 24px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            padding: 16px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
        }
        
        tr:hover {
            background-color: #f9fafb;
        }
        
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-left: 5px;
            transition: var(--transition);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-btn.delete {
            color: var(--danger);
            background: rgba(247, 37, 133, 0.1);
        }
        
        .action-btn.delete:hover {
            background: rgba(247, 37, 133, 0.2);
        }
        
        .action-btn.edit {
            color: var(--info);
            background: rgba(72, 149, 239, 0.1);
        }
        
        .action-btn.edit:hover {
            background: rgba(72, 149, 239, 0.2);
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .chart-box {
            background: white;
            border-radius: var(--card-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        .chart-box:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .category-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 5px;
            background: var(--primary);
            color: white;
        }
        
        .recurring-badge {
            background: var(--success);
        }
        
        .investment-badge {
            background: var(--info);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            color: var(--gray);
            font-size: 14px;
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--danger);
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            th, td {
                padding: 12px 8px;
                font-size: 14px;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Finan√ßas360</h1>
            <p class="subtitle">Controle completo das suas finan√ßas em um s√≥ lugar</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="dashboard">Dashboard</div>
            <div class="tab" data-tab="income">Ganhos</div>
            <div class="tab" data-tab="expenses">Gastos</div>
            <div class="tab" data-tab="loans">Empr√©stimos</div>
            <div class="tab" data-tab="investments">Investimentos</div>
            <div class="tab" data-tab="reports">Relat√≥rios</div>
        </div>
        
        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard-tab">
            <div class="dashboard">
                <div class="dashboard-card">
                    <h3><i class="fas fa-hand-holding-usd"></i> Total a Receber</h3>
                    <div class="dashboard-value" id="totalAmount">R$ 0,00</div>
                    <div class="real-time" id="lastUpdate">Atualizado em: --:--:--</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-university"></i> Valor Emprestado</h3>
                    <div class="dashboard-value value-neutral" id="totalLoaned">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-money-bill-wave"></i> Juros Acumulados</h3>
                    <div class="dashboard-value value-positive" id="totalInterest">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-list-ol"></i> Empr√©stimos Ativos</h3>
                    <div class="dashboard-value" id="activeLoans">0</div>
                </div>
            </div>
            
            <div class="dashboard">
                <div class="dashboard-card">
                    <h3><i class="fas fa-wallet"></i> Saldo Atual</h3>
                    <div class="dashboard-value" id="currentBalance">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-arrow-up"></i> Total de Ganhos</h3>
                    <div class="dashboard-value value-positive" id="totalIncome">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-arrow-down"></i> Total de Gastos</h3>
                    <div class="dashboard-value value-negative" id="totalExpenses">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-exchange-alt"></i> Transa√ß√µes</h3>
                    <div class="dashboard-value" id="totalTransactions">0</div>
                </div>
            </div>
            
            <div class="dashboard">
                <div class="dashboard-card">
                    <h3><i class="fas fa-chart-line"></i> Valor Investido</h3>
                    <div class="dashboard-value value-positive" id="totalInvested">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-piggy-bank"></i> Rendimento Mensal</h3>
                    <div class="dashboard-value value-positive" id="monthlyEarnings">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-calendar"></i> Gastos Recorrentes</h3>
                    <div class="dashboard-value value-negative" id="monthlyExpenses">R$ 0,00</div>
                </div>
                <div class="dashboard-card">
                    <h3><i class="fas fa-calendar-check"></i> Ganhos Recorrentes</h3>
                    <div class="dashboard-value value-positive" id="monthlyIncome">R$ 0,00</div>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-box">
                    <h3 class="card-title"><i class="fas fa-chart-line"></i> Proje√ß√£o de Recebimento (Pr√≥ximos 30 Dias)</h3>
                    <canvas id="projectionChart"></canvas>
                </div>
                <div class="chart-box">
                    <h3 class="card-title"><i class="fas fa-chart-pie"></i> Distribui√ß√£o de Gastos por Categoria</h3>
                    <canvas id="expensesChart"></canvas>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-box">
                    <h3 class="card-title"><i class="fas fa-coins"></i> Distribui√ß√£o de Investimentos</h3>
                    <canvas id="investmentsChart"></canvas>
                </div>
                <div class="chart-box">
                    <h3 class="card-title"><i class="fas fa-money-bill-trend-up"></i> Evolu√ß√£o Patrimonial (6 meses)</h3>
                    <canvas id="wealthChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Ganhos Tab -->
        <div class="tab-content" id="income-tab">
            <div class="controls">
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-plus-circle"></i> Novo Ganho</h2>
                    <div class="input-group">
                        <label for="incomeAmount">Valor (R$)</label>
                        <input type="number" id="incomeAmount" min="0.01" step="0.01" placeholder="Ex: 150,75">
                    </div>
                    <div class="input-group">
                        <label for="incomeCategory">Categoria</label>
                        <select id="incomeCategory">
                            <option value="Sal√°rio">Sal√°rio</option>
                            <option value="Freelance">Freelance</option>
                            <option value="Investimentos">Investimentos</option>
                            <option value="Presente">Presente</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="incomeDate">Data</label>
                        <input type="datetime-local" id="incomeDate">
                    </div>
                    <div class="input-group">
                        <label for="incomeDescription">Descri√ß√£o (opcional)</label>
                        <textarea id="incomeDescription" placeholder="Ex: Pagamento do cliente XYZ"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="incomeRecurring">
                            <input type="checkbox" id="incomeRecurring"> √â uma receita recorrente?
                        </label>
                    </div>
                    <div id="incomeRecurringOptions" style="display: none;">
                        <div class="input-group">
                            <label for="incomeRecurringFrequency">Frequ√™ncia</label>
                            <select id="incomeRecurringFrequency">
                                <option value="weekly">Semanal</option>
                                <option value="monthly" selected>Mensal</option>
                                <option value="quarterly">Trimestral</option>
                                <option value="yearly">Anual</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-success" id="addIncomeBtn">
                        <i class="fas fa-plus"></i> Adicionar Ganho
                    </button>
                </div>
                
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-info-circle"></i> Informa√ß√µes</h2>
                    <p>Registre todos os seus ganhos para ter um controle financeiro completo.</p>
                    <p style="margin-top: 15px;">Categorize seus ganhos para entender melhor de onde vem sua renda.</p>
                    <div style="margin-top: 20px;">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Saldo Inicial</h3>
                        <div class="input-group">
                            <label for="initialBalance">Valor Inicial (R$)</label>
                            <input type="number" id="initialBalance" step="0.01" placeholder="Ex: 1000,00">
                        </div>
                        <button class="btn btn-primary" id="setInitialBalanceBtn">
                            <i class="fas fa-save"></i> Definir Saldo Inicial
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-arrow-up"></i> Meus Ganhos
                </h2>
                
                <table id="incomeTable">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Descri√ß√£o</th>
                            <th>Categoria</th>
                            <th>Valor</th>
                            <th>Recorrente</th>
                            <th>A√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody id="incomeTableBody">
                        <!-- Os ganhos ser√£o listados aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Gastos Tab -->
        <div class="tab-content" id="expenses-tab">
            <div class="controls">
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-plus-circle"></i> Novo Gasto</h2>
                    <div class="input-group">
                        <label for="expenseAmount">Valor (R$)</label>
                        <input type="number" id="expenseAmount" min="0.01" step="0.01" placeholder="Ex: 150,75">
                    </div>
                    <div class="input-group">
                        <label for="expenseCategory">Categoria</label>
                        <select id="expenseCategory">
                            <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
                            <option value="Transporte">Transporte</option>
                            <option value="Combust√≠vel">Combust√≠vel</option>
                            <option value="Moradia">Moradia</option>
                            <option value="Sa√∫de">Sa√∫de</option>
                            <option value="Educa√ß√£o">Educa√ß√£o</option>
                            <option value="Lazer">Lazer</option>
                            <option value="Assinaturas">Assinaturas (Netflix, Spotify)</option>
                            <option value="Servi√ßos">Servi√ßos (iCloud, Google)</option>
                            <option value="Compras">Compras</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="expenseDate">Data</label>
                        <input type="datetime-local" id="expenseDate">
                    </div>
                    <div class="input-group">
                        <label for="expenseDescription">Descri√ß√£o (opcional)</label>
                        <textarea id="expenseDescription" placeholder="Ex: Supermercado"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="expenseRecurring">
                            <input type="checkbox" id="expenseRecurring"> √â uma despesa recorrente?
                        </label>
                    </div>
                    <div id="expenseRecurringOptions" style="display: none;">
                        <div class="input-group">
                            <label for="expenseRecurringFrequency">Frequ√™ncia</label>
                            <select id="expenseRecurringFrequency">
                                <option value="weekly">Semanal</option>
                                <option value="monthly" selected>Mensal</option>
                                <option value="quarterly">Trimestral</option>
                                <option value="yearly">Anual</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-danger" id="addExpenseBtn">
                        <i class="fas fa-plus"></i> Adicionar Gasto
                    </button>
                </div>
                
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-info-circle"></i> Informa√ß√µes</h2>
                    <p>Registre todos os seus gastos para ter um controle financeiro completo.</p>
                    <p style="margin-top: 15px;">Categorize seus gastos para identificar para onde seu dinheiro est√° indo.</p>
                    <div style="margin-top: 20px;">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Gastos Recorrentes</h3>
                        <p>Marque gastos que se repeten regularmente para acompanhar melhor suas despesas fixas.</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-arrow-down"></i> Meus Gastos
                </h2>
                
                <table id="expensesTable">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Descri√ß√£o</th>
                            <th>Categoria</th>
                            <th>Valor</th>
                            <th>Recorrente</th>
                            <th>A√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody id="expensesTableBody">
                        <!-- Os gastos ser√£o listados aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Empr√©stimos Tab -->
        <div class="tab-content" id="loans-tab">
            <div class="controls">
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-plus-circle"></i> Novo Empr√©stimo</h2>
                    <div class="input-group">
                        <label for="loanAmount">Valor Emprestado (R$)</label>
                        <input type="number" id="loanAmount" min="1" step="0.01" placeholder="Ex: 1000">
                    </div>
                    <div class="input-group">
                        <label for="loanInterest">Taxa de Juros (% ao m√™s)</label>
                        <input type="number" id="loanInterest" min="0.1" step="0.1" placeholder="Ex: 5">
                    </div>
                    <div class="input-group">
                        <label for="loanDate">Data do Empr√©stimo</label>
                        <input type="datetime-local" id="loanDate">
                    </div>
                    <div class="input-group">
                        <label for="loanDebtor">Nome do Devedor (opcional)</label>
                        <input type="text" id="loanDebtor" placeholder="Ex: Jo√£o Silva">
                    </div>
                    <button class="btn btn-primary" id="addLoanBtn">
                        <i class="fas fa-plus"></i> Adicionar Empr√©stimo
                    </button>
                </div>
                
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-calculator"></i> Simula√ß√£o</h2>
                    <div class="input-group">
                        <label for="simulationAmount">Valor para Simular (R$)</label>
                        <input type="number" id="simulationAmount" value="7000" min="100" step="100">
                    </div>
                    <div class="input-group">
                        <label for="simulationInterest">Taxa de Juros (% ao m√™s)</label>
                        <input type="number" id="simulationInterest" value="5" min="0.1" step="0.1">
                    </div>
                    <div class="input-group">
                        <label for="simulationDays">Dias para Simular</label>
                        <input type="number" id="simulationDays" value="30" min="1" max="365" step="1">
                    </div>
                    <button class="btn btn-success" id="simulateBtn">
                        <i class="fas fa-calculator"></i> Calcular Simula√ß√£o
                    </button>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-history"></i> Meus Empr√©stimos Ativos
                </h2>
                
                <table id="loansTable">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Devedor</th>
                            <th>Valor Emprestado</th>
                            <th>Taxa de Juros</th>
                            <th>Juros Acumulados</th>
                            <th>Total a Receber</th>
                            <th>A√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody id="loansTableBody">
                        <!-- Os empr√©stimos ser√£o listados aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Investimentos Tab -->
        <div class="tab-content" id="investments-tab">
            <div class="controls">
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-plus-circle"></i> Novo Investimento</h2>
                    <div class="input-group">
                        <label for="investmentType">Tipo de Investimento</label>
                        <select id="investmentType">
                            <option value="stock">A√ß√£o</option>
                            <option value="fiis">FIIs</option>
                            <option value="fixed_income">Renda Fixa</option>
                            <option value="crypto">Criptomoeda</option>
                            <option value="etf">ETF</option>
                            <option value="other">Outro</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="investmentName">Nome do Ativo</label>
                        <input type="text" id="investmentName" placeholder="Ex: PETR4, MXRF11, CDB">
                    </div>
                    <div class="input-group">
                        <label for="investmentAmount">Valor Investido (R$)</label>
                        <input type="number" id="investmentAmount" min="0.01" step="0.01" placeholder="Ex: 1000,00">
                    </div>
                    <div class="input-group">
                        <label for="investmentQuantity">Quantidade</label>
                        <input type="number" id="investmentQuantity" min="0.000001" step="0.000001" placeholder="Ex: 100">
                    </div>
                    <div class="input-group">
                        <label for="investmentDate">Data da Aplica√ß√£o</label>
                        <input type="datetime-local" id="investmentDate">
                    </div>
                    <div class="input-group">
                        <label for="investmentReturn">Taxa de Retorno Esperada (% ao ano)</label>
                        <input type="number" id="investmentReturn" step="0.01" placeholder="Ex: 6,5">
                    </div>
                    <button class="btn btn-primary" id="addInvestmentBtn">
                        <i class="fas fa-plus"></i> Adicionar Investimento
                    </button>
                </div>
                
                <div class="control-group">
                    <h2 class="control-title"><i class="fas fa-chart-line"></i> Cota√ß√µes em Tempo Real</h2>
                    <p>Consulta de valores atualizados de ativos</p>
                    
                    <div class="input-group">
                        <label for="quoteSymbol">C√≥digo do Ativo</label>
                        <input type="text" id="quoteSymbol" placeholder="Ex: PETR4, BTC-USD">
                    </div>
                    <button class="btn btn-success" id="getQuoteBtn">
                        <i class="fas fa-search"></i> Buscar Cota√ß√£o
                    </button>
                    
                    <div id="quoteResult" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; display: none;">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Resultado da Cota√ß√£o</h3>
                        <div id="quoteDetails"></div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Ativos Populares</h3>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-warning" data-symbol="PETR4.SA">
                                <i class="fas fa-bolt"></i> PETR4
                            </button>
                            <button class="btn btn-warning" data-symbol="VALE3.SA">
                                <i class="fas fa-bolt"></i> VALE3
                            </button>
                            <button class="btn btn-warning" data-symbol="MXRF11.SA">
                                <i class="fas fa-bolt"></i> MXRF11
                            </button>
                            <button class="btn btn-warning" data-symbol="BTC-USD">
                                <i class="fas fa-bolt"></i> Bitcoin
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-coins"></i> Meus Investimentos
                </h2>
                
                <table id="investmentsTable">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Ativo</th>
                            <th>Valor Investido</th>
                            <th>Quantidade</th>
                            <th>Retorno Esperado</th>
                            <th>Valor Atual</th>
                            <th>A√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody id="investmentsTableBody">
                        <!-- Os investimentos ser√£o listados aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Relat√≥rios Tab -->
        <div class="tab-content" id="reports-tab">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-chart-bar"></i> Relat√≥rios Financeiros
                </h2>
                
                <div class="controls">
                    <div class="control-group">
                        <h2 class="control-title"><i class="fas fa-filter"></i> Filtros</h2>
                        <div class="input-group">
                            <label for="reportMonth">M√™s</label>
                            <select id="reportMonth">
                                <option value="0">Janeiro</option>
                                <option value="1">Fevereiro</option>
                                <option value="2">Mar√ßo</option>
                                <option value="3">Abril</option>
                                <option value="4">Maio</option>
                                <option value="5">Junho</option>
                                <option value="6">Julho</option>
                                <option value="7">Agosto</option>
                                <option value="8">Setembro</option>
                                <option value="9">Outubro</option>
                                <option value="10">Novembro</option>
                                <option value="11">Dezembro</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="reportYear">Ano</label>
                            <input type="number" id="reportYear" min="2020" max="2030" value="2023">
                        </div>
                        <button class="btn btn-primary" id="generateReportBtn">
                            <i class="fas fa-sync"></i> Gerar Relat√≥rio
                        </button>
                    </div>
                    
                    <div class="control-group">
                        <h2 class="control-title"><i class="fas fa-file-export"></i> Exportar Dados</h2>
                        <p>Exporte seus dados financeiros para an√°lise externa ou backup.</p>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-success" id="exportLoansBtn" style="width: 100%; margin-bottom: 10px;">
                                <i class="fas fa-download"></i> Exportar Empr√©stimos
                            </button>
                            <button class="btn btn-success" id="exportIncomeBtn" style="width: 100%; margin-bottom: 10px;">
                                <i class="fas fa-download"></i> Exportar Ganhos
                            </button>
                            <button class="btn btn-success" id="exportExpensesBtn" style="width: 100%; margin-bottom: 10px;">
                                <i class="fas fa-download"></i> Exportar Gastos
                            </button>
                            <button class="btn btn-success" id="exportInvestmentsBtn" style="width: 100%;">
                                <i class="fas fa-download"></i> Exportar Investimentos
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="charts-container">
                    <div class="chart-box">
                        <h3 class="card-title"><i class="fas fa-chart-line"></i> Evolu√ß√£o do Saldo</h3>
                        <canvas id="balanceChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3 class="card-title"><i class="fas fa-chart-pie"></i> Distribui√ß√£o de Gastos</h3>
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
                
                <div class="charts-container">
                    <div class="chart-box">
                        <h3 class="card-title"><i class="fas fa-money-bill-trend-up"></i> Rentabilidade dos Investimentos</h3>
                        <canvas id="returnsChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3 class="card-title"><i class="fas fa-calendar"></i> Previs√£o de Receitas e Despesas</h3>
                        <canvas id="forecastChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Finan√ßas360 - Sistema de Controle Financeiro - Desenvolvido para organiza√ß√£o financeira pessoal</p>
            <p>¬© 2023 - Todos os direitos reservados</p>
        </footer>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Vari√°veis globais
        let loans = [];
        let transactions = [];
        let investments = [];
        let recurringIncomes = [];
        let initialBalance = 0;
        let projectionChart = null;
        let expensesChart = null;
        let investmentsChart = null;
        let wealthChart = null;
        let balanceChart = null;
        let categoryChart = null;
        let returnsChart = null;
        let forecastChart = null;
        let updateInterval = null;
        let currentTab = 'dashboard';
        
        // Cores para categorias
        const categoryColors = {
            'Alimenta√ß√£o': '#FF6384',
            'Transporte': '#36A2EB',
            'Combust√≠vel': '#FF6384',
            'Moradia': '#FFCE56',
            'Sa√∫de': '#4BC0C0',
            'Educa√ß√£o': '#9966FF',
            'Lazer': '#FF9F40',
            'Assinaturas': '#C9CBCF',
            'Servi√ßos': '#8d99ae',
            'Compras': '#FF6384',
            'Sal√°rio': '#2ecc71',
            'Freelance': '#3498db',
            'Investimentos': '#9b59b6',
            'Presente': '#FF9F40',
            'Outros': '#95a5a6'
        };
        
        // Dados de exemplo para cota√ß√µes (simulados)
        const mockQuotes = {
            'PETR4.SA': { price: 28.45, change: 1.2, name: 'Petr√≥leo Brasileiro S/A' },
            'VALE3.SA': { price: 72.30, change: -0.8, name: 'Vale S/A' },
            'MXRF11.SA': { price: 10.25, change: 0.3, name: 'Maxi Renda Fundo de Investimento Imobili√°rio' },
            'BTC-USD': { price: 145230.50, change: 2.5, name: 'Bitcoin' },
            'ETH-USD': { price: 8250.75, change: 1.8, name: 'Ethereum' },
            'ITSA4.SA': { price: 9.87, change: 0.5, name: 'Ita√∫sa Investimentos Ita√∫ S/A' },
            'BBDC4.SA': { price: 17.32, change: -1.2, name: 'Bradesco S/A' }
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Configurar eventos para elementos interativos
            document.getElementById('incomeRecurring').addEventListener('change', function() {
                document.getElementById('incomeRecurringOptions').style.display = this.checked ? 'block' : 'none';
            });
            
            document.getElementById('expenseRecurring').addEventListener('change', function() {
                document.getElementById('expenseRecurringOptions').style.display = this.checked ? 'block' : 'none';
            });
            
            // Adicionar eventos para bot√µes de cota√ß√µes r√°pidas
            document.querySelectorAll('button[data-symbol]').forEach(button => {
                button.addEventListener('click', function() {
                    const symbol = this.getAttribute('data-symbol');
                    document.getElementById('quoteSymbol').value = symbol;
                    getQuote();
                });
            });
            
            // Carregar dados do localStorage
            loadDataFromStorage();
            
            // Configurar data/hora atual como padr√£o para novos registros
            const now = new Date();
            const localDateTime = new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().slice(0, 16);
            document.getElementById('loanDate').value = localDateTime;
            document.getElementById('incomeDate').value = localDateTime;
            document.getElementById('expenseDate').value = localDateTime;
            document.getElementById('investmentDate').value = localDateTime;
            document.getElementById('reportYear').value = now.getFullYear();
            document.getElementById('reportMonth').value = now.getMonth();
            
            // Adicionar eventos aos bot√µes
            document.getElementById('addLoanBtn').addEventListener('click', addNewLoan);
            document.getElementById('simulateBtn').addEventListener('click', showSimulation);
            document.getElementById('addIncomeBtn').addEventListener('click', addNewIncome);
            document.getElementById('addExpenseBtn').addEventListener('click', addNewExpense);
            document.getElementById('setInitialBalanceBtn').addEventListener('click', setInitialBalance);
            document.getElementById('generateReportBtn').addEventListener('click', generateReport);
            document.getElementById('exportLoansBtn').addEventListener('click', exportLoans);
            document.getElementById('exportIncomeBtn').addEventListener('click', exportIncome);
            document.getElementById('exportExpensesBtn').addEventListener('click', exportExpenses);
            document.getElementById('exportInvestmentsBtn').addEventListener('click', exportInvestments);
            document.getElementById('addInvestmentBtn').addEventListener('click', addNewInvestment);
            document.getElementById('getQuoteBtn').addEventListener('click', getQuote);
            
            // Iniciar atualiza√ß√£o em tempo real
            startRealTimeUpdates();
            
            // Atualizar a interface
            updateDashboard();
            updateLoansTable();
            updateIncomeTable();
            updateExpensesTable();
            updateInvestmentsTable();
            updateCharts();
        });
        
        function switchTab(tabName) {
            // Atualizar tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            currentTab = tabName;
            
            // Atualizar gr√°ficos espec√≠ficos da tab se necess√°rio
            if (tabName === 'reports') {
                generateReport();
            } else if (tabName === 'dashboard') {
                updateCharts();
            }
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function loadDataFromStorage() {
            const storedLoans = localStorage.getItem('loanTrackerLoans');
            const storedTransactions = localStorage.getItem('financialTransactions');
            const storedInvestments = localStorage.getItem('financialInvestments');
            const storedRecurringIncomes = localStorage.getItem('recurringIncomes');
            const storedInitialBalance = localStorage.getItem('initialBalance');
            
            if (storedLoans) {
                loans = JSON.parse(storedLoans);
                
                // Converter strings de data para objetos Date
                loans.forEach(loan => {
                    loan.date = new Date(loan.date);
                });
            }
            
            if (storedTransactions) {
                transactions = JSON.parse(storedTransactions);
                
                // Converter strings de data para objetos Date
                transactions.forEach(transaction => {
                    transaction.date = new Date(transaction.date);
                });
            }
            
            if (storedInvestments) {
                investments = JSON.parse(storedInvestments);
                
                // Converter strings de data para objetos Date
                investments.forEach(investment => {
                    investment.date = new Date(investment.date);
                });
            }
            
            if (storedRecurringIncomes) {
                recurringIncomes = JSON.parse(storedRecurringIncomes);
            }
            
            if (storedInitialBalance) {
                initialBalance = parseFloat(storedInitialBalance);
                document.getElementById('initialBalance').value = initialBalance;
            }
        }
        
        function saveDataToStorage() {
            localStorage.setItem('loanTrackerLoans', JSON.stringify(loans));
            localStorage.setItem('financialTransactions', JSON.stringify(transactions));
            localStorage.setItem('financialInvestments', JSON.stringify(investments));
            localStorage.setItem('recurringIncomes', JSON.stringify(recurringIncomes));
            localStorage.setItem('initialBalance', initialBalance);
        }
        
        function addNewLoan() {
            const amount = parseFloat(document.getElementById('loanAmount').value);
            const interestRate = parseFloat(document.getElementById('loanInterest').value);
            const dateString = document.getElementById('loanDate').value;
            const debtor = document.getElementById('loanDebtor').value || 'N√£o informado';
            
            if (!amount || amount <= 0 || !interestRate || interestRate <= 0 || !dateString) {
                showNotification('Por favor, preencha todos os campos obrigat√≥rios com valores v√°lidos.', 'error');
                return;
            }
            
            // Converter para objeto Date
            const date = new Date(dateString);
            
            // Adicionar o novo empr√©stimo
            const newLoan = {
                id: Date.now(), // ID √∫nico baseado no timestamp
                amount: amount,
                interestRate: interestRate,
                date: date,
                debtor: debtor
            };
            
            loans.push(newLoan);
            saveDataToStorage();
            
            // Limpar o formul√°rio
            document.getElementById('loanAmount').value = '';
            document.getElementById('loanInterest').value = '';
            document.getElementById('loanDebtor').value = '';
            
            // Atualizar a interface
            updateDashboard();
            updateLoansTable();
            updateCharts();
            
            showNotification('Empr√©stimo adicionado com sucesso!');
        }
        
        function addNewIncome() {
            const amount = parseFloat(document.getElementById('incomeAmount').value);
            const category = document.getElementById('incomeCategory').value;
            const dateString = document.getElementById('incomeDate').value;
            const description = document.getElementById('incomeDescription').value || 'Sem descri√ß√£o';
            const isRecurring = document.getElementById('incomeRecurring').checked;
            const recurringFrequency = document.getElementById('incomeRecurringFrequency').value;
            
            if (!amount || amount <= 0 || !dateString) {
                showNotification('Por favor, preencha todos os campos obrigat√≥rios com valores v√°lidos.', 'error');
                return;
            }
            
            // Converter para objeto Date
            const date = new Date(dateString);
            
            // Adicionar a nova transa√ß√£o
            const newTransaction = {
                id: Date.now(), // ID √∫nico baseado no timestamp
                type: 'income',
                amount: amount,
                category: category,
                date: date,
                description: description,
                isRecurring: isRecurring,
                recurringFrequency: isRecurring ? recurringFrequency : null
            };
            
            transactions.push(newTransaction);
            saveDataToStorage();
            
            // Limpar o formul√°rio
            document.getElementById('incomeAmount').value = '';
            document.getElementById('incomeDescription').value = '';
            document.getElementById('incomeRecurring').checked = false;
            document.getElementById('incomeRecurringOptions').style.display = 'none';
            
            // Atualizar a interface
            updateDashboard();
            updateIncomeTable();
            updateCharts();
            
            showNotification('Ganho adicionado com sucesso!');
        }
        
        function addNewExpense() {
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const category = document.getElementById('expenseCategory').value;
            const dateString = document.getElementById('expenseDate').value;
            const description = document.getElementById('expenseDescription').value || 'Sem descri√ß√£o';
            const isRecurring = document.getElementById('expenseRecurring').checked;
            const recurringFrequency = document.getElementById('expenseRecurringFrequency').value;
            
            if (!amount || amount <= 0 || !dateString) {
                showNotification('Por favor, preencha todos os campos obrigat√≥rios com valores v√°lidos.', 'error');
                return;
            }
            
            // Converter para objeto Date
            const date = new Date(dateString);
            
            // Adicionar a nova transa√ß√£o
            const newTransaction = {
                id: Date.now(), // ID √∫nico baseado no timestamp
                type: 'expense',
                amount: amount,
                category: category,
                date: date,
                description: description,
                isRecurring: isRecurring,
                recurringFrequency: isRecurring ? recurringFrequency : null
            };
            
            transactions.push(newTransaction);
            saveDataToStorage();
            
            // Limpar o formul√°rio
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseDescription').value = '';
            document.getElementById('expenseRecurring').checked = false;
            document.getElementById('expenseRecurringOptions').style.display = 'none';
            
            // Atualizar a interface
            updateDashboard();
            updateExpensesTable();
            updateCharts();
            
            showNotification('Gasto adicionado com sucesso!');
        }
        
        function addNewInvestment() {
            const type = document.getElementById('investmentType').value;
            const name = document.getElementById('investmentName').value;
            const amount = parseFloat(document.getElementById('investmentAmount').value);
            const quantity = parseFloat(document.getElementById('investmentQuantity').value);
            const dateString = document.getElementById('investmentDate').value;
            const returnRate = parseFloat(document.getElementById('investmentReturn').value) || 0;
            
            if (!name || !amount || amount <= 0 || !quantity || quantity <= 0 || !dateString) {
                showNotification('Por favor, preencha todos os campos obrigat√≥rios com valores v√°lidos.', 'error');
                return;
            }
            
            // Converter para objeto Date
            const date = new Date(dateString);
            
            // Adicionar o novo investimento
            const newInvestment = {
                id: Date.now(), // ID √∫nico baseado no timestamp
                type: type,
                name: name,
                amount: amount,
                quantity: quantity,
                date: date,
                returnRate: returnRate
            };
            
            investments.push(newInvestment);
            saveDataToStorage();
            
            // Limpar o formul√°rio
            document.getElementById('investmentName').value = '';
            document.getElementById('investmentAmount').value = '';
            document.getElementById('investmentQuantity').value = '';
            document.getElementById('investmentReturn').value = '';
            
            // Atualizar a interface
            updateDashboard();
            updateInvestmentsTable();
            updateCharts();
            
            showNotification('Investimento adicionado com sucesso!');
        }
        
        function setInitialBalance() {
            const balance = parseFloat(document.getElementById('initialBalance').value) || 0;
            initialBalance = balance;
            saveDataToStorage();
            updateDashboard();
            showNotification('Saldo inicial definido com sucesso!');
        }
        
        function removeLoan(loanId) {
            if (confirm('Tem certeza que deseja remover este empr√©stimo?')) {
                loans = loans.filter(loan => loan.id !== loanId);
                saveDataToStorage();
                
                // Atualizar a interface
                updateDashboard();
                updateLoansTable();
                updateCharts();
                
                showNotification('Empr√©stimo removido com sucesso!');
            }
        }
        
        function removeTransaction(transactionId) {
            if (confirm('Tem certeza que deseja remover esta transa√ß√£o?')) {
                transactions = transactions.filter(transaction => transaction.id !== transactionId);
                saveDataToStorage();
                
                // Atualizar a interface
                updateDashboard();
                updateIncomeTable();
                updateExpensesTable();
                updateCharts();
                
                showNotification('Transa√ß√£o removida com sucesso!');
            }
        }
        
        function removeInvestment(investmentId) {
            if (confirm('Tem certeza que deseja remover este investimento?')) {
                investments = investments.filter(investment => investment.id !== investmentId);
                saveDataToStorage();
                
                // Atualizar a interface
                updateDashboard();
                updateInvestmentsTable();
                updateCharts();
                
                showNotification('Investimento removido com sucesso!');
            }
        }
        
        function calculateLoanValue(loan) {
            const now = new Date();
            const loanDate = new Date(loan.date);
            
            // Calcular diferen√ßa em milissegundos
            const diffMs = now - loanDate;
            
            // Converter para dias (arredondando para baixo)
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            // Calcular juros proporcionais
            const dailyRate = loan.interestRate / 30 / 100; // Taxa di√°ria
            const interest = loan.amount * dailyRate * diffDays;
            
            // Valor total a receber
            const total = loan.amount + interest;
            
            return {
                days: diffDays,
                interest: interest,
                total: total
            };
        }
        
        function calculateBalance() {
            let balance = initialBalance;
            
            // Adicionar ganhos
            transactions.filter(t => t.type === 'income').forEach(t => {
                balance += t.amount;
            });
            
            // Subtrair gastos
            transactions.filter(t => t.type === 'expense').forEach(t => {
                balance -= t.amount;
            });
            
            return balance;
        }
        
        function calculateTotals() {
            let totalIncome = 0;
            let totalExpenses = 0;
            
            transactions.forEach(transaction => {
                if (transaction.type === 'income') {
                    totalIncome += transaction.amount;
                } else {
                    totalExpenses += transaction.amount;
                }
            });
            
            return {
                income: totalIncome,
                expenses: totalExpenses
            };
        }
        
        function calculateRecurringMonthly() {
            let monthlyIncome = 0;
            let monthlyExpenses = 0;
            
            // Calcular receitas recorrentes
            transactions.filter(t => t.isRecurring && t.type === 'income').forEach(income => {
                if (income.recurringFrequency === 'weekly') {
                    monthlyIncome += income.amount * 4.33;
                } else if (income.recurringFrequency === 'monthly') {
                    monthlyIncome += income.amount;
                } else if (income.recurringFrequency === 'quarterly') {
                    monthlyIncome += income.amount / 3;
                } else if (income.recurringFrequency === 'yearly') {
                    monthlyIncome += income.amount / 12;
                }
            });
            
            // Calcular despesas recorrentes
            transactions.filter(t => t.isRecurring && t.type === 'expense').forEach(expense => {
                if (expense.recurringFrequency === 'weekly') {
                    monthlyExpenses += expense.amount * 4.33;
                } else if (expense.recurringFrequency === 'monthly') {
                    monthlyExpenses += expense.amount;
                } else if (expense.recurringFrequency === 'quarterly') {
                    monthlyExpenses += expense.amount / 3;
                } else if (expense.recurringFrequency === 'yearly') {
                    monthlyExpenses += expense.amount / 12;
                }
            });
            
            return {
                income: monthlyIncome,
                expenses: monthlyExpenses
            };
        }
        
        function updateDashboard() {
            let totalAmount = 0;
            let totalLoaned = 0;
            let totalInterest = 0;
            
            loans.forEach(loan => {
                const calculated = calculateLoanValue(loan);
                totalLoaned += loan.amount;
                totalInterest += calculated.interest;
                totalAmount += calculated.total;
            });
            
            const totals = calculateTotals();
            const balance = calculateBalance();
            const recurring = calculateRecurringMonthly();
            const invested = investments.reduce((sum, inv) => sum + inv.amount, 0);
            const monthlyEarnings = investments.reduce((sum, inv) => sum + (inv.amount * (inv.returnRate / 100) / 12), 0);
            
            document.getElementById('totalAmount').textContent = formatCurrency(totalAmount);
            document.getElementById('totalLoaned').textContent = formatCurrency(totalLoaned);
            document.getElementById('totalInterest').textContent = formatCurrency(totalInterest);
            document.getElementById('activeLoans').textContent = loans.length;
            
            document.getElementById('currentBalance').textContent = formatCurrency(balance);
            document.getElementById('totalIncome').textContent = formatCurrency(totals.income);
            document.getElementById('totalExpenses').textContent = formatCurrency(totals.expenses);
            document.getElementById('totalTransactions').textContent = transactions.length;
            
            document.getElementById('totalInvested').textContent = formatCurrency(invested);
            document.getElementById('monthlyEarnings').textContent = formatCurrency(monthlyEarnings);
            document.getElementById('monthlyExpenses').textContent = formatCurrency(recurring.expenses);
            document.getElementById('monthlyIncome').textContent = formatCurrency(recurring.income);
            
            // Atualizar hor√°rio da √∫ltima atualiza√ß√£o
            const now = new Date();
            document.getElementById('lastUpdate').textContent = `Atualizado em: ${formatTime(now)}`;
        }
        
        function updateLoansTable() {
            const tableBody = document.getElementById('loansTableBody');
            tableBody.innerHTML = '';
            
            if (loans.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7">Nenhum empr√©stimo registrado</td></tr>';
                return;
            }
            
            // Ordenar empr√©stimos do mais recente para o mais antigo
            const sortedLoans = [...loans].sort((a, b) => b.date - a.date);
            
            sortedLoans.forEach(loan => {
                const calculated = calculateLoanValue(loan);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${formatDate(loan.date)}</td>
                    <td>${loan.debtor}</td>
                    <td>${formatCurrency(loan.amount)}</td>
                    <td>${loan.interestRate.toFixed(2)}%</td>
                    <td>${formatCurrency(calculated.interest)}</td>
                    <td>${formatCurrency(calculated.total)}</td>
                    <td>
                        <button class="action-btn delete" onclick="removeLoan(${loan.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function updateIncomeTable() {
            const tableBody = document.getElementById('incomeTableBody');
            tableBody.innerHTML = '';
            
            const incomeTransactions = transactions.filter(t => t.type === 'income');
            
            if (incomeTransactions.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6">Nenhum ganho registrado</td></tr>';
                return;
            }
            
            // Ordenar transa√ß√µes do mais recente para o mais antigo
            const sortedTransactions = [...incomeTransactions].sort((a, b) => b.date - a.date);
            
            sortedTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const recurringBadge = transaction.isRecurring ? 
                    `<span class="category-badge recurring-badge">${transaction.recurringFrequency === 'weekly' ? 'Semanal' : 
                      transaction.recurringFrequency === 'monthly' ? 'Mensal' : 
                      transaction.recurringFrequency === 'quarterly' ? 'Trimestral' : 'Anual'}</span>` : '';
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.description}</td>
                    <td><span class="category-badge" style="background: ${categoryColors[transaction.category] || '#95a5a6'}">${transaction.category}</span></td>
                    <td style="color: #2ecc71">+ ${formatCurrency(transaction.amount)}</td>
                    <td>${recurringBadge}</td>
                    <td>
                        <button class="action-btn delete" onclick="removeTransaction(${transaction.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function updateExpensesTable() {
            const tableBody = document.getElementById('expensesTableBody');
            tableBody.innerHTML = '';
            
            const expenseTransactions = transactions.filter(t => t.type === 'expense');
            
            if (expenseTransactions.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6">Nenhum gasto registrado</td></tr>';
                return;
            }
            
            // Ordenar transa√ß√µes do mais recente para o mais antigo
            const sortedTransactions = [...expenseTransactions].sort((a, b) => b.date - a.date);
            
            sortedTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                const recurringBadge = transaction.isRecurring ? 
                    `<span class="category-badge recurring-badge">${transaction.recurringFrequency === 'weekly' ? 'Semanal' : 
                      transaction.recurringFrequency === 'monthly' ? 'Mensal' : 
                      transaction.recurringFrequency === 'quarterly' ? 'Trimestral' : 'Anual'}</span>` : '';
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.description}</td>
                    <td><span class="category-badge" style="background: ${categoryColors[transaction.category] || '#95a5a6'}">${transaction.category}</span></td>
                    <td style="color: #e74c3c">- ${formatCurrency(transaction.amount)}</td>
                    <td>${recurringBadge}</td>
                    <td>
                        <button class="action-btn delete" onclick="removeTransaction(${transaction.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function updateInvestmentsTable() {
            const tableBody = document.getElementById('investmentsTableBody');
            tableBody.innerHTML = '';
            
            if (investments.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8">Nenhum investimento registrado</td></tr>';
                return;
            }
            
            // Ordenar investimentos do mais recente para o mais antigo
            const sortedInvestments = [...investments].sort((a, b) => b.date - a.date);
            
            sortedInvestments.forEach(investment => {
                const row = document.createElement('tr');
                const currentValue = investment.amount * (1 + (investment.returnRate / 100));
                
                row.innerHTML = `
                    <td>${formatDate(investment.date)}</td>
                    <td>${getInvestmentTypeName(investment.type)}</td>
                    <td>${investment.name}</td>
                    <td>${formatCurrency(investment.amount)}</td>
                    <td>${investment.quantity}</td>
                    <td>${investment.returnRate.toFixed(2)}%</td>
                    <td>${formatCurrency(currentValue)}</td>
                    <td>
                        <button class="action-btn delete" onclick="removeInvestment(${investment.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function getInvestmentTypeName(type) {
            const types = {
                'stock': 'A√ß√£o',
                'fiis': 'FIIs',
                'fixed_income': 'Renda Fixa',
                'crypto': 'Criptomoeda',
                'etf': 'ETF',
                'other': 'Outro'
            };
            return types[type] || type;
        }
        
        function updateCharts() {
            updateProjectionChart();
            updateExpensesChart();
            updateInvestmentsChart();
            updateWealthChart();
        }
        
        function updateProjectionChart() {
            const ctx = document.getElementById('projectionChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (projectionChart) {
                projectionChart.destroy();
            }
            
            // Gerar dados de proje√ß√£o para os pr√≥ximos 30 dias
            const days = Array.from({length: 30}, (_, i) => i + 1);
            const projectionData = days.map(day => {
                let total = 0;
                loans.forEach(loan => {
                    const loanDate = new Date(loan.date);
                    const futureDate = new Date();
                    futureDate.setDate(futureDate.getDate() + day);
                    
                    const diffMs = futureDate - loanDate;
                    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                    
                    if (diffDays > 0) {
                        const dailyRate = loan.interestRate / 30 / 100;
                        const interest = loan.amount * dailyRate * diffDays;
                        total += loan.amount + interest;
                    } else {
                        total += loan.amount; // Ainda n√£o come√ßou a gerar juros
                    }
                });
                return total;
            });
            
            // Criar o gr√°fico
            projectionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'Proje√ß√£o de Valor a Receber',
                        data: projectionData,
                        borderColor: '#4a6491',
                        backgroundColor: 'rgba(74, 100, 145, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Proje√ß√£o dos Pr√≥ximos 30 Dias'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'Dia ' + context.label + ': ' + formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Valor (R$)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Dias'
                            }
                        }
                    }
                }
            });
        }
        
        function updateExpensesChart() {
            const ctx = document.getElementById('expensesChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (expensesChart) {
                expensesChart.destroy();
            }
            
            // Calcular totais por categoria
            const expensesByCategory = {};
            transactions.filter(t => t.type === 'expense').forEach(transaction => {
                if (!expensesByCategory[transaction.category]) {
                    expensesByCategory[transaction.category] = 0;
                }
                expensesByCategory[transaction.category] += transaction.amount;
            });
            
            const categories = Object.keys(expensesByCategory);
            const amounts = Object.values(expensesByCategory);
            const backgroundColors = categories.map(cat => categoryColors[cat] || '#95a5a6');
            
            // Criar o gr√°fico
            expensesChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categories,
                    datasets: [{
                        data: amounts,
                        backgroundColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.parsed);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateInvestmentsChart() {
            const ctx = document.getElementById('investmentsChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (investmentsChart) {
                investmentsChart.destroy();
            }
            
            // Calcular totais por tipo de investimento
            const investmentsByType = {};
            investments.forEach(investment => {
                if (!investmentsByType[investment.type]) {
                    investmentsByType[investment.type] = 0;
                }
                investmentsByType[investment.type] += investment.amount;
            });
            
            const types = Object.keys(investmentsByType);
            const amounts = Object.values(investmentsByType);
            const backgroundColors = types.map((type, index) => {
                const colors = ['#4cc9f0', '#4895ef', '#4361ee', '#3a0ca3', '#7209b7', '#f72585'];
                return colors[index % colors.length];
            });
            
            // Criar o gr√°fico
            investmentsChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: types.map(type => getInvestmentTypeName(type)),
                    datasets: [{
                        data: amounts,
                        backgroundColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.parsed);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateWealthChart() {
            const ctx = document.getElementById('wealthChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (wealthChart) {
                wealthChart.destroy();
            }
            
            // Gerar dados de evolu√ß√£o patrimonial (√∫ltimos 6 meses)
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            const now = new Date();
            const currentMonth = now.getMonth();
            
            const labels = [];
            const data = [];
            
            for (let i = 5; i >= 0; i--) {
                const monthIndex = (currentMonth - i + 12) % 12;
                labels.push(months[monthIndex]);
                
                // Simular crescimento patrimonial (em uma aplica√ß√£o real, isso viria dos dados)
                const baseValue = 10000 + (Math.random() * 5000);
                data.push(baseValue + (i * 1500));
            }
            
            // Criar o gr√°fico
            wealthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Evolu√ß√£o Patrimonial',
                        data: data,
                        borderColor: '#4cc9f0',
                        backgroundColor: 'rgba(76, 201, 240, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evolu√ß√£o dos √öltimos 6 Meses'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Valor (R$)'
                            }
                        }
                    }
                }
            });
        }
        
        function generateReport() {
            const selectedMonth = parseInt(document.getElementById('reportMonth').value);
            const selectedYear = parseInt(document.getElementById('reportYear').value);
            
            // Filtrar transa√ß√µes pelo m√™s/ano selecionado
            const filteredTransactions = transactions.filter(transaction => {
                const transactionDate = new Date(transaction.date);
                return transactionDate.getMonth() === selectedMonth && 
                       transactionDate.getFullYear() === selectedYear;
            });
            
            // Atualizar gr√°ficos do relat√≥rio
            updateBalanceChart(filteredTransactions, selectedMonth, selectedYear);
            updateCategoryChart(filteredTransactions);
            updateReturnsChart();
            updateForecastChart();
        }
        
        function updateBalanceChart(transactions, month, year) {
            const ctx = document.getElementById('balanceChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (balanceChart) {
                balanceChart.destroy();
            }
            
            // Calcular saldo di√°rio
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const dailyBalance = Array(daysInMonth).fill(initialBalance);
            
            // Aplicar transa√ß√µes
            transactions.forEach(transaction => {
                const day = new Date(transaction.date).getDate() - 1; // √çndice 0-based
                if (transaction.type === 'income') {
                    for (let i = day; i < daysInMonth; i++) {
                        dailyBalance[i] += transaction.amount;
                    }
                } else {
                    for (let i = day; i < daysInMonth; i++) {
                        dailyBalance[i] -= transaction.amount;
                    }
                }
            });
            
            // Criar o gr√°fico
            balanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: daysInMonth}, (_, i) => i + 1),
                    datasets: [{
                        label: 'Saldo Di√°rio',
                        data: dailyBalance,
                        borderColor: '#4a6491',
                        backgroundColor: 'rgba(74, 100, 145, 0.1)',
                        borderWidth: 2,
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evolu√ß√£o do Saldo no M√™s'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'Dia ' + context.label + ': ' + formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Saldo (R$)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Dia do M√™s'
                            }
                        }
                    }
                }
            });
        }
        
        function updateCategoryChart(transactions) {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (categoryChart) {
                categoryChart.destroy();
            }
            
            // Calcular totais por categoria
            const expensesByCategory = {};
            transactions.filter(t => t.type === 'expense').forEach(transaction => {
                if (!expensesByCategory[transaction.category]) {
                    expensesByCategory[transaction.category] = 0;
                }
                expensesByCategory[transaction.category] += transaction.amount;
            });
            
            const categories = Object.keys(expensesByCategory);
            const amounts = Object.values(expensesByCategory);
            const backgroundColors = categories.map(cat => categoryColors[cat] || '#95a5a6');
            
            // Criar o gr√°fico
            categoryChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categories,
                    datasets: [{
                        data: amounts,
                        backgroundColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.parsed);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateReturnsChart() {
            const ctx = document.getElementById('returnsChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (returnsChart) {
                returnsChart.destroy();
            }
            
            // Dados de exemplo para rentabilidade
            const labels = investments.map(inv => inv.name);
            const expectedReturns = investments.map(inv => inv.returnRate);
            const actualReturns = investments.map(inv => inv.returnRate + (Math.random() * 5 - 2.5)); // Simular varia√ß√£o
            
            // Criar o gr√°fico
            returnsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Retorno Esperado',
                            data: expectedReturns,
                            backgroundColor: 'rgba(76, 201, 240, 0.7)',
                            borderColor: '#4cc9f0',
                            borderWidth: 1
                        },
                        {
                            label: 'Retorno Real (simulado)',
                            data: actualReturns,
                            backgroundColor: 'rgba(114, 9, 183, 0.7)',
                            borderColor: '#7209b7',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Rentabilidade dos Investimentos'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2) + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Retorno (%)'
                            }
                        }
                    }
                }
            });
        }
        
        function updateForecastChart() {
            const ctx = document.getElementById('forecastChart').getContext('2d');
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (forecastChart) {
                forecastChart.destroy();
            }
            
            // Dados de exemplo para previs√£o
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'];
            const incomeData = [2500, 2500, 2500, 2500, 2500, 2500];
            const expensesData = [1800, 1900, 1850, 1950, 2000, 1900];
            
            // Criar o gr√°fico
            forecastChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: 'Receitas',
                            data: incomeData,
                            backgroundColor: 'rg
